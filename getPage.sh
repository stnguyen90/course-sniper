#!/bin/bash

#List of Terms
if [ $(date +%m) -ge 7 ]; then
	Fall=$(date +%y)F
	Winter=$(date --date="next year" +%y)W
	Spring=$(date --date="next year" +%y)S
else
	Fall=$(date +%y)F
	Winter=$(date +%y)W
	Spring=$(date +%y)S
fi

#Begin Selecting Term
Term=$(zenity  --list  --text "Please choose a Term" --radiolist --print-column=3 --hide-column=3 --column "Choice" --column "Term" --column "Code" False "Fall" $Fall False "Winter" $Winter False "Spring" $Spring)

#Begin Selecting Subject
Subject=$(zenity --width=400 --height=400 --list --text "Please Choose a Subject" --radiolist --print-column=3 --hide-column=3 --column "Choice" --column "Subject" --column "Code" False "Aerospace Studies" "AERO+ST" False "African Languages" "AF+LANG" False "African Languages (Pre-Fall 2009)" "AFRICAN" False "African Studies" "AFRC+ST" False "Afrikaans" "AFRKAAN" False "Afro-American Studies" "AFRO-AM" False "American Indian Studies" "AM+IND" False "Ancient Near East" "AN+N+EA" False "Anesthesiology" "ANES" False "Anthropology" "ANTHRO" False "Applied Linguistics" "APPLING" False "Applied Linguistics and Teaching English a..." "AP%26TESL" False "Applied Linguistics (Pre-Fall 2009)" "AP+LING" False "Arabic" "ARABIC" False "Archaeology" "ARCHEOL" False "Architecture and Urban Design" "ARCH%26UD" False "Armenian" "ARMENIA" False "Art" "ART" False "Art History" "ART+HIS" False "Arts and Architecture" "ART%26ARC" False "Asian" "ASIAN" False "Asian American Studies" "ASIA+AM" False "Astronomy" "ASTR" False "Atmospheric and Oceanic Sciences " "A%26O+SCI" False "Berber" "BERBER" False "Bioengineering" "BIOENGR" False "Bioinformatics" "BIOINFO" False "Biological Chemistry" "BIOL+CH" False "Biomathematics" "BIOMATH" False "Biomedical Engineering" "BIOMED" False "Biomedical Physics" "BMEDPHY" False "Biomedical Research" "BMD+RES" False "Biostatistics" "BIOSTAT" False "Bulgarian" "BULGAR" False "Central and East European Studies " "CEE+STD" False "Chemical Engineering" "CH+ENGR" False "Chemistry and Biochemistry" "CHEM" False "Chicana and Chicano Studies" "CHICANO" False "Chinese" "CHIN" False "Civic Engagement" "CIVIC" False "Civil and Environmental Engineering" "C%26EE" False "Classics" "CLASSIC" False "Communication Studies" "COMM+ST" False "Community Health Sciences" "COM+HLT" False "Comparative Literature" "COM+LIT" False "Computational and Systems Biology" "C%26S+BIO" False "Computer Science" "COM+SCI" False "Conservation of Archaeological Ethnographi..." "CAEM" False "Czech" "CZECH" False "Dance" "DANCE" False "Dentistry" "DENT" False "Design | Media Arts" "DESMA" False "Disability Studies" "DIS+STD" False "Dutch" "DUTCH" False "Earth and Space Sciences" "E%26S+SCI" False "East Asian Studies" "E+A+STD" False "Ecology and Evolutionary Biology " "EE+BIOL" False "Economics" "ECON" False "Education" "EDUC" False "Electrical Engineering" "EL+ENGR" False "Engineering" "ENGR" False "English" "ENGL" False "English as a Second Language" "ESL" False "English Composition" "ENGCOMP" False "Environment" "ENVIRON" False "Environmental Health Sciences" "ENV+HLT" False "Environmental Science and Engineering" "ENV+SCI" False "Epidemiology" "EPIDEM" False "Ethnomusicology" "ETHNOMU" False "European Studies" "EURO+ST" False "Family Medicine" "FAM+MED" False "Filipino" "FILIPNO" False "Film and Television" "FILM+TV" False "French" "FRNCH" False "General Education Clusters" "GE+CLST" False "Geography" "GEOG" False "Geriatrics" "GERIATR" False "German" "GERMAN" False "Gerontology" "GRNTLGY" False "Global Studies" "GLBL+ST" False "Greek" "GREEK" False "Health Services" "HLT+SER" False "Hebrew" "HEBREW" False "Hindi-Urdu" "HIN-URD" False "History" "HIST" False "Honors Collegium" "HNRS" False "Human Complex Systems" "HUM+CS" False "Human Genetics" "HUM+GEN" False "Hungarian" "HUNGRN" False "Indigenous Languages of the Americas (pre-..." "ILA" False "Indo-European Studies" "I+E+STD" False "Indonesian" "INDO" False "Information Studies" "INF+STD" False "International Development Studies" "INTL+DV" False "Iranian" "IRANIAN" False "Islamics" "ISLAMIC" False "Islamic Studies" "ISLM+ST" False "Italian" "ITALIAN" False "Japanese" "JAPAN" False "Jewish Studies" "JEWISH" False "Korean" "KOREA" False "Labor and Workplace Studies" "LBR%26WS" False "Latin" "LATIN" False "Latin American Studies" "LATN+AM" False "Law" "LAW" False "Law, Undergraduate" "UG-LAW" False "Lesbian, Gay, Bisexual, and Transgender St..." "LGBTS" False "Life Sciences" "LIFESCI" False "Linguistics" "LING" False "Lithuanian" "LITHUAN" False "Management" "MGMT" False "Materials Science and Engineering" "MAT+SCI" False "Mathematics" "MATH" False "Mechanical and Aerospace Engineering" "MECH%26AE" False "Medical History" "MED+HIS" False "Medicine" "MED" False "Microbiology, Immunology, and Molecular Ge..." "MIMG" False "Middle Eastern and North African Studies" "MENAS" False "Military Science" "MIL+SCI" False "Molecular and Medical Pharmacology" "M+PHARM" False "Molecular Biology" "MOL+BIO" False "Molecular, Cell, and Developmental Biology" "MCD+BIO" False "Molecular, Cellular, and Integrative Physi..." "MC%26IP" False "Molecular Toxicology" "MOL+TOX" False "Moving Image Archive Studies" "MIA+STD" False "Music" "MUSIC" False "Music History" "MUS+HST" False "Musicology" "MUSCLGY" False "Naval Science" "NAV+SCI" False "Near Eastern Languages" "NR+EAST" False "Neurobiology" "NEURBIO" False "Neurology" "NEURLGY" False "Neuroscience" "NEUROSC" False "Neuroscience (Graduate)" "NEURO" False "Neurosurgery" "NEURSGY" False "Nursing" "NURSING" False "Obstetrics and Gynecology" "OBGYN" False "Old Norse" "NORSE" False "Opthalmology" "OPTH" False "Oral Biology" "ORL+BIO" False "Orthopaedic Surgery" "ORTHPDC" False "Pathology and Laboratory Medicine" "PATH" False "Pediatrics" "PEDS" False "Philosophy" "PHILOS" False "Physics" "PHYSICS" False "Physiological Science" "PHYSCI" False "Physiological Science (Pre-Fall 2010)" "PHY+SCI" False "Physiology" "PHYSIOL" False "Polish" "POLISH" False "Political Science" "POL+SCI" False "Portuguese" "PORTGSE" False "Program in Computing" "COMPTNG" False "Psychiatry and Biobehavioral Sciences" "PSYCTRY" False "Psychology" "PSYCH" False "Public Health" "PUB+HLT" False "Public Policy" "PUB+PLC" False "Quechua" "QUECHUA" False "Radiation Oncology" "RAD+ONC" False "Religion, Study of" "RELIGN" False "Romanian" "ROMAN" False "Russian" "RUSSIAN" False "Scandinavian" "SCAND" False "Semitics" "SEMITIC" False "Serbian/Croatian" "SER+CRO" False "Slavic" "SLAVIC" False "Social Thought" "SOC+THT" False "Social Welfare" "SOC+WLF" False "Society and Genetics" "SOC+GEN" False "Sociology" "SOCIOL" False "South Asian" "S+ASIAN" False "Southeast Asian" "SEASIAN" False "Southeast Asian Studies" "SE+A+ST" False "Spanish" "SPAN" False "Statistics" "STATS" False "Surgery" "SURGERY" False "Thai" "THAI" False "Theater" "THEATER" False "Turkic Languages" "TURKIC" False "Ukrainian" "UKRAIN" False "Urban Planning" "URBN+PL" False "Urology" "UROLOGY" False "Vietnamese" "VIETMSE" False "Women's Studies" "WOM+STD" False "World Arts and Cultures" "WLD+ART" False "Yiddish" "YIDDSH")

#Begin Selecting Course

shortSub=$(echo ${Subject} | sed "s/\+/ /g" | sed "s/%26/ & /g")

wget -q -O temp_course_page "http://www.registrar.ucla.edu/schedule/crsredir.aspx?termsel=11W&subareasel=${Subject}" | tee >(zenity --progress --pulsate --auto-close --text="Fetching Data...")

CoursesList=()
while read -d $'.'; do
	CoursesList+=("$REPLY")
done < <(grep "<option value=" temp_course_page | sed -e "s/\(value=\"....\) /\1+/g" -e "s/\(value=\".....\) /\1+/g" -e "s/\(value=\"......\) /\1+/g" -e "s/\(value=\".......\) /\1+/g" | sed "s/\t\t\t\t<option value=\"\([^\"]*\)\">/\1=/g" | sed "s/\([^=]*\)=\([^<]*\)<\/option>/False.\2.\1./g" | sed "s/[\n\r]//g")

Course=$(zenity --width=400 --height=400 --list --text "Please Choose a Subject" --radiolist --print-column=3 --hide-column=3 --column "Choice" --column "Subject" --column "Code" "${CoursesList[@]}")

Link="http://www.registrar.ucla.edu/schedule/detselect.aspx?termsel=${Term}&subareasel=${Subject}&idxcrs=${Course}"

./getCourseInfo.sh $Link
